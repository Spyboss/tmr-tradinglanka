# Server Configuration
# Copy values into a local `.env` (ignored by git) for development
# and provide production secrets via your hosting environment.
PORT=8080
NODE_ENV=development
# NODE_ENV must be set. Use `development` locally and `production` in Railway/Cloud.

# MongoDB Connection
MONGODB_URI=mongodb://localhost:27017/tmr
# Optional: database name; defaults to `tmr` if unset
MONGODB_DB_NAME=tmr
# Required in production: backend fails fast if MONGODB_URI is missing.

# CORS / Cookies
# If set, overrides default allowlist. Comma-separated URLs.
# Example for Cloudflare Pages frontend:
CORS_ORIGINS=https://tmr-tradinglanka.pages.dev
# When false, requests without an Origin header are blocked (e.g., curl)
# Leave unset or set to true to preserve legacy behavior.
ALLOW_NO_ORIGIN=false

# Security Keys (Replace with strong random values in production)
# Generate with: openssl rand -base64 32
JWT_SECRET=replace_with_at_least_32_chars_long_random_string
# Required: JWT_SECRET must be at least 32 characters. Backend warns in dev and fails fast in prod if shorter.
# Generate with: openssl rand -base64 32
# Must be at least 32 characters long per encryption service
ENCRYPTION_KEY=replace_with_at_least_32_chars_long_random_string
# Backend fails fast if ENCRYPTION_KEY is shorter than 32 characters.

# Redis Configuration (for token revocation and rate limiting)
# Required in production. In local development, Redis is optional (backend uses an in-memory mock).
REDIS_URL=redis://localhost:6379

# Admin User Configuration
ADMIN_EMAIL=admin@gunawardanamotors.lk
ADMIN_PASSWORD=replace_with_strong_password
ADMIN_NAME=System Administrator
ADMIN_SETUP_KEY=replace_with_super_secure_admin_setup_key

# Rate Limiting Configuration
RATE_LIMIT_WINDOW_MS=60000
RATE_LIMIT_MAX_REQUESTS=100

# Cookie Settings
COOKIE_SECRET=replace_with_strong_random_string
# Used to sign cookies where applicable.

# Logging
LOG_LEVEL=info
# Accepted values: error, warn, info, http, verbose, debug, silly

# AWS KMS Configuration (for enterprise-grade encryption)
# AWS_REGION=us-east-1
# KMS_KEY_ID=your-kms-key-id

# Email Verification (Phase 1 scaffolding)
# Feature flag: leave false until rollout
EMAIL_VERIFICATION_ENABLED=false
# Token TTL in minutes
VERIFICATION_TOKEN_TTL_MINUTES=30
# Public base URL used to build verification links
PUBLIC_BASE_URL=https://tmr-tradinglanka.pages.dev
# Mailer provider: 'resend' or 'console' (console logs emails)
EMAIL_PROVIDER=console
# Default From address
EMAIL_FROM=TMR Trading Lanka <no-reply@gunawardanamotors.lk>
# Resend API Key (if using 'resend')
RESEND_API_KEY=

# Email Verification Enforcement (Phase 2)
# Gate enforcement to require verified email on private routes.
# Keep false initially; enabling triggers friendly 403 for non-verified users.
EMAIL_VERIFICATION_ENFORCE=false
# Accounts created before this ISO date are treated as legacy and bypass enforcement.
# Example: 2025-01-01T00:00:00.000Z
EMAIL_VERIFICATION_ENFORCE_CUTOFF_ISO=